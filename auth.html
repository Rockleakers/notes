<!DOCTYPE html>
<html lang="en">

<head>
    <!-- <meta charset="UTF-8"> -->
    <!-- <meta name="viewport" content="width=device-width, initial-scale=1.0"> -->
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-TJPDZLLRB7"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
          gtag('js', new Date());
          
            gtag('config', 'G-TJPDZLLRB7');
            </script>
    <link rel="stylesheet" href="style.css">
    <title>Document</title>

    <script>
        function redirectTo(url) {
            location.replace(url);
        }
    </script>
</head>

<body>
    <!-- <h1 id="welcome-message">Authenticated Page</h1> -->
    <!-- <p>Only logged-in users should see this content.</p> -->
    <div class="header">
        <p id="timer">Your session will expire in: 00:00:00</p> <!-- Timer display -->
        <div class="btn btn-green-filled" onclick="logout()">Logout</div>
        <div style="display: inline-block;"><a href="main.html" class="btn btn-grey-filled"
                style="color: #000;text-decoration: none;">Main page</a></div>
    </div>
    <center>
        <table width="100%" cellspacing="0" cellpadding="0">
            <caption>Internet and Mobile Programming</caption>
            <thead>
                <tr>
                    <th>Ex. No</th>
                    <th>Title</th>
                    <th>Link</th>
                    <th>Additional Resource</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td rowspan="5">1</td>
                    <td rowspan="5">Create a web page with the following using HTML</td>
                    <td><a href="fileViewer.html?file=/imp/Main.html">Main.html</a></td>
                </tr>
                
                <tr>
                    <td><a href="fileViewer.html?file=/imp/Tamilnadu.html">Tamilnadu.html</a></td>
                    <td></td>

                </tr>

                <tr>
                    <td><a href="fileViewer.html?file=/imp/Kerala.html">Kerala.html</a></td>
                    <td></td>
                </tr>
                <tr>
                    <td><a href="fileViewer.html?file=/imp/delhi.html">delhi.html</a></td>
                    <td></td>
                </tr>
                <tr>
                    <td><a href="fileViewer.html?file=/imp/Bihar.html">Bihar.html</a></td>
                    <td></td>
                </tr>

                <tr>
                    <td rowspan="6">2</td>
                    <td rowspan="6">Create a Web Page Using HTML with CSS </td>
                    <td><a href="fileViewer.html?file=/imp/index.html">index.html</a></td>
                    
                </tr>

                <tr>
                    <td><a href="fileViewer.html?file=/imp/inline.html">inline.html</a></td>

                </tr>
                <tr>
                    <td><a href="fileViewer.html?file=/imp/embedded.html">embedded.html</a></td>

                </tr>
                <tr>
                    <td><a href="fileViewer.html?file=/imp/external.html">external.html</a></td>

                </tr>


                <tr>
                    <td><a href="fileViewer.html?file=/imp/import.html">import.html</a></td>

                </tr>
                <tr>
                    <td><a href="fileViewer.html?file=/imp/style2.css">style2.css</a></td>

                </tr>
                <tr></tr>

                <tr>
                    <td colspan="3">Coming Soon...</td>
                </tr>

                <!-- <tr>
                    <td><a href="fileViewer.html?file=/imp/Activity_main.xml">Activity_main.xml</a></td>
                    <td><a href="fileViewer.html?file=/imp/Activity_main2.xml">Activity_main2.xml</a></td>
                    <td><a href="fileViewer.html?file=/imp/Ajaxphp.html">Ajaxphp.html</a></td>
                    <td><a href="fileViewer.html?file=/imp/Ajaxtext.html">Ajaxtext.html</a></td>
                    <td><a href="fileViewer.html?file=/imp/Ajax_get.html">Ajax_get.html</a></td>
                    <td><a href="fileViewer.html?file=/imp/ajax_info.txt">ajax_info.txt</a></td>
                    <td><a href="fileViewer.html?file=/imp/Book.html">Book.html</a></td>
                    <td><a href="fileViewer.html?file=/imp/book.xml">book.xml</a></td>
                    <td><a href="fileViewer.html?file=/imp/Book_Catlog.xml">Book_Catlog.xml</a></td>
                    <td><a href="fileViewer.html?file=/imp/Calculator.html">Calculator.html</a></td>
                    <td><a href="fileViewer.html?file=/imp/confirmation.php">confirmation.php</a></td>
                    <td><a href="fileViewer.html?file=/imp/form.html">form.html</a></td>
                    <td><a href="fileViewer.html?file=/imp/india.png">india.png</a></td>
                    <td><a href="fileViewer.html?file=/imp/login.html">login.html</a></td>
                    <td><a href="fileViewer.html?file=/imp/login2.html">login2.html</a></td>
                    <td><a href="fileViewer.html?file=/imp/MainActivity.java">MainActivity.java</a></td>
                    <td><a href="fileViewer.html?file=/imp/MainActivity2.java">MainActivity2.java</a></td>
                    <td><a href="fileViewer.html?file=/imp/mouse.html">mouse.html</a></td>
                    <td><a href="fileViewer.html?file=/imp/regform.html">regform.html</a></td>
                    <td><a href="fileViewer.html?file=/imp/Shop.html">Shop.html</a></td>
                    <td><a href="fileViewer.html?file=/imp/Student.xml">Student.xml</a></td>
                    <td><a href="fileViewer.html?file=/imp/style3.css">style3.css</a></td>
                </tr> -->

            </tbody>
            <tfoot>
                <tr>
                    <td rowspan="2">Study Materials</td>
                    <td>Internet and Mobile Programming Lab Manual</td>
                    <td><a href="/pdfjs/web/viewer.html?file=/imp.pdf">IMP.pdf</a></td>
                </tr>
                <tr>
                    <td>All IMP Programs (Compressed format)</td>
                    <!-- <td><a href="nc.zip">IMP.zip</a></td> -->
                    <td>Coming Soon...</td>
                </tr>
            </tfoot>
        </table>
    </center>
    <script src="prevent.js"></script>
    <script>

        let countdownInterval; // Variable to hold the countdown interval

        // Function to check if the session is valid
        function checkSession() {
            const userName = localStorage.getItem('userName');
            const sessionExpiry = localStorage.getItem('sessionExpiry');

            // If session exists
            if (userName && sessionExpiry) {
                // Check if the session has expired
                if (Date.now() > sessionExpiry) {
                    console.log('Session expired. Redirecting to login.');
                    clearSession();
                    return false; // Session is not valid
                } else {
                    console.log('Session is valid for user:', userName);
                    return true; // Session is valid
                }
            }
            console.log('No session found. Redirecting to login.');
            return false; // No session found
        }

        // Function to clear session data
        function clearSession() {
            localStorage.removeItem('userName');
            localStorage.removeItem('sessionExpiry');
            location.href = "index.html"; // Redirect to the login page
        }

        // Function to display the welcome message
        function displayWelcomeMessage() {
            const userName = localStorage.getItem('userName');
            console.log('Welcome, ' + userName);
            // if (userName) {
            //     document.getElementById('welcome-message').textContent = "Welcome, " + userName + "!";
            // }
        }

        // Function to start the countdown timer
        function startCountdown() {
            const sessionExpiry = localStorage.getItem('sessionExpiry');

            // Update the timer every second
            countdownInterval = setInterval(() => {
                let remainingTime = sessionExpiry - Date.now(); // Calculate remaining time
                // remainingTime -= 1000; // Decrease by 1 second

                if (remainingTime <= 0) {
                    clearInterval(countdownInterval); // Clear the interval
                    clearSession(); // Redirect if the time is up
                } else {
                    const seconds = Math.floor((remainingTime / 1000) % 60);
                    const minutes = Math.floor((remainingTime / 1000 / 60) % 60);
                    const hours = Math.floor((remainingTime / 1000 / 3600) % 24);
                    const formattedTime = `${String(hours).padStart(2, '0')}:${String(minutes).padStart(2, '0')}:${String(seconds).padStart(2, '0')}`;
                    document.getElementById('timer').textContent = `Your session will expire in: ${formattedTime}`;
                }
            }, 1000); // Update every second
        }

        // Check the session immediately on page load
        window.onload = function () {
            if (checkSession()) {
                displayWelcomeMessage(); // Show welcome message only if session is valid
                startCountdown(); // Start the countdown timer
                // Set up an interval to check the session every 5 seconds
                setInterval(function () {
                    if (!checkSession()) {
                        clearSession(); // Redirect if session is invalid
                    }
                }, 10000);
                // Check every 10000 milliseconds (10 seconds)
            } else {
                clearSession(); // Redirect if session is invalid
            }
        };

        function logout() {
            clearSession(); // Use the clearSession function for logout
        }
    </script>
</body>

</html>